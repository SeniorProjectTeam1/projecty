<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI-Powered Senior Project Ideation</title>

  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    * { font-family: 'Inter', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg,#10b981 0%,#047857 100%); } /* green */
    .card-shadow { box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04); }
    .btn-primary { background: linear-gradient(135deg,#016a32 0%,#064e3b 100%); transition: all .18s ease; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow:0 8px 20px rgba(1,106,50,0.18); }
    .innovation-slider { -webkit-appearance:none; appearance:none; height:8px; border-radius:6px; background:#e6f4ea; outline:none; }
    .innovation-slider::-webkit-slider-thumb { -webkit-appearance:none; width:22px; height:22px; border-radius:50%; background:#10b981; cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,0.12); }
    .loading-spinner { border:4px solid #f3f3f3; border-top:4px solid #10b981; border-radius:50%; width:26px; height:26px; animation:spin 1s linear infinite; }
    @keyframes spin { 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }
    .project-card { border-left:4px solid #10b981; transition:all .18s ease; }
    .project-card:hover { transform: translateY(-4px); box-shadow:0 15px 30px -10px rgba(0,0,0,0.08); }
    .tech-tag { display:inline-block; margin:2px 4px 2px 0; padding:4px 8px; font-size:0.75rem; border-radius:999px; background: rgba(16,185,129,0.08); color:#065f46; border:1px solid rgba(16,185,129,0.12); }
    .market-data { white-space:pre-wrap; }
    .error-message { background:#fee2e2; border-left:4px solid #ef4444; color:#991b1b; padding:12px; border-radius:8px; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="w-full max-w-7xl mx-auto p-6 space-y-6">
    <!-- Header -->
    <div class="gradient-bg text-white p-8 rounded-2xl card-shadow">
      <div class="flex items-center justify-center space-x-4">
        <i class="fas fa-lightbulb text-3xl"></i>
        <h1 class="text-3xl md:text-4xl font-bold">AI-Powered Ideation — Senior Project</h1>
      </div>
      <p class="text-center mt-3 opacity-90">Generate & score senior design project ideas — view the top 3 and fetch market insights per idea.</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left: config -->
      <div class="lg:col-span-1 space-y-6">
        <div class="bg-white p-6 rounded-xl card-shadow">
          <h2 class="text-xl font-semibold mb-4"><i class="fas fa-cog text-green-600 mr-2"></i>Configuration</h2>
          <div class="space-y-3">
            <label class="text-sm font-medium">OpenAI API Key</label>
            <input id="apiKey" type="password" placeholder="sk-..." class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-600" />
            <label class="text-sm font-medium mt-2">Category</label>
            <select id="category" class="w-full p-3 border rounded-lg">
              <option value="">Any</option>
              <option>edtech</option>
              <option>iot/embedded</option>
              <option>health</option>
              <option>fintech</option>
              <option>sustainability</option>
              <option>campus life</option>
            </select>
            <label class="text-sm font-medium mt-2">Model</label>
            <select id="aiModel" class="w-full p-3 border rounded-lg">
              <option value="gpt-4">gpt-4</option>
              <option value="gpt-4o">gpt-4o</option>
              <option value="gpt-4o-mini">gpt-4o-mini</option>
              <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
            </select>
          </div>
        </div>

        <div class="bg-white p-6 rounded-xl card-shadow">
          <h2 class="text-xl font-semibold mb-4"><i class="fas fa-sliders-h text-green-600 mr-2"></i>Project Parameters</h2>
          <div class="space-y-3">
            <label class="text-sm font-medium">Topic context (optional)</label>
            <textarea id="topicContext" rows="2" placeholder="Extra constraints or context" class="w-full p-3 border rounded-lg"></textarea>

            <label class="text-sm font-medium">Preferred Technologies</label>
            <div class="grid grid-cols-2 gap-2 text-sm">
              <label><input type="checkbox" class="tech-checkbox" value="AI/ML"> AI/ML</label>
              <label><input type="checkbox" class="tech-checkbox" value="IoT"> IoT</label>
              <label><input type="checkbox" class="tech-checkbox" value="Mobile"> Mobile</label>
              <label><input type="checkbox" class="tech-checkbox" value="Web"> Web</label>
              <label><input type="checkbox" class="tech-checkbox" value="Embedded"> Embedded</label>
              <label><input type="checkbox" class="tech-checkbox" value="Robotics"> Robotics</label>
              <label><input type="checkbox" class="tech-checkbox" value="Control"> Control</label>
              <label><input type="checkbox" class="tech-checkbox" value="Security"> Security</label>
            </div>

            <!-- sliders -->
            <div class="mt-2">
              <label class="text-sm font-medium">Innovation (1 practical → 10 radical)</label>
              <input id="innovation" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
              <div class="flex justify-between text-xs text-gray-500"><span>practical</span><span>radical</span></div>
            </div>

            <div class="mt-2">
              <label class="text-sm font-medium">Technical difficulty (1 low → 10 high)</label>
              <input id="techLevel" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
            </div>

            <div class="grid grid-cols-2 gap-2 mt-2">
              <label class="text-sm">Resources (1 few → 10 many)</label>
              <label class="text-sm">Speed (1 slow → 10 fast)</label>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <input id="resources" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
              <input id="speed" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
            </div>

            <div class="grid grid-cols-2 gap-2">
              <label class="text-sm">Price (1 low → 10 high)</label>
              <label class="text-sm">Market Strength (1 weak → 10 strong)</label>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <input id="price" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
              <input id="marketStrength" type="range" min="1" max="10" value="5" class="innovation-slider w-full">
            </div>

            <div class="flex gap-2 mt-3">
              <button id="generateBtn" class="btn-primary text-white py-2 px-4 rounded-lg flex-1 flex items-center justify-center gap-2">
                <i class="fas fa-magic"></i> Generate
              </button>
              <button id="clearBtn" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg flex-1 hover:bg-gray-300">
                <i class="fas fa-trash"></i> Clear
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right: results -->
      <div class="lg:col-span-2">
        <div id="loadingMessage" class="hidden bg-white p-6 rounded-xl card-shadow mb-4 flex items-center gap-3">
          <div class="loading-spinner"></div>
          <span class="font-medium">Generating project ideas...</span>
        </div>

        <div id="errorMessage" class="hidden error-message mb-4"></div>

        <div id="resultsContainer" class="space-y-4"></div>
      </div>
    </div>
  </div>

  <script>
    class AIIdeationTool {
      constructor() {
        this.apiKey = '';
        this.model = 'gpt-4';
        this.setupEventListeners();
      }

      setupEventListeners() {
        document.getElementById('generateBtn').addEventListener('click', () => this.generateProjects());
        document.getElementById('clearBtn').addEventListener('click', () => this.clearAll());
        document.getElementById('apiKey').addEventListener('input', e => this.apiKey = e.target.value.trim());
        document.getElementById('aiModel').addEventListener('change', e => this.model = e.target.value);
      }

      // Build strong JSON-only prompt to return an array of 10 project objects
      buildPrompt(params) {
        const exampleSchema = `
Return STRICT JSON only (no commentary). Provide top-level value that is an array (no wrapper object):
[
  {
    "title": "Short title",
    "description": "2-3 sentences",
    "components": ["Raspberry Pi", "Camera", "WiFi"],
    "technologies": ["IoT","Computer Vision"],
    "cost": "$300 - $600",
    "timeline": "8-month milestones (month1..month8)",
    "marketAppeal": "students, campus, admin",
    "challenges": "privacy, calibration",
    "uniqueValue": "what makes it different",
    "innovation": 7
  },
  ...
]

Produce exactly 10 objects in the array, each with these keys. Use arrays for components and technologies, numbers for innovation (1-10), and short strings for other fields.
`;

        const prefTech = params.technologies.length ? params.technologies.join(', ') : 'Any';
        const ctx = params.topicContext ? `Context: ${params.topicContext}\n` : '';
        const cat = params.category ? `Category: ${params.category}\n` : '';
        const header = `${ctx}${cat}Target: Senior design (4 students, 1 academic year). Constraints: Budget ${params.budget}, Complexity ${params.complexity}. Desired innovation ${params.innovation}/10. Preferred technologies: ${prefTech}.`;
        return header + '\n\n' + exampleSchema + '\nGenerate 10 project ideas that fit these constraints.';
      }

      // Extract JSON substring robustly
      extractJson(text) {
        // if content includes ```json blocks, strip fences
        const fenced = text.match(/```(?:json)?\s*([\s\S]*?)\s*```/i);
        if (fenced) text = fenced[1];

        // Try direct parse
        try { const parsed = JSON.parse(text); return parsed; } catch (e) {}

        // Try extracting first [...] block
        const firstBracket = text.indexOf('[');
        const lastBracket = text.lastIndexOf(']');
        if (firstBracket !== -1 && lastBracket !== -1 && lastBracket > firstBracket) {
          const sub = text.slice(firstBracket, lastBracket + 1);
          try { return JSON.parse(sub); } catch (e) {}
        }

        // Try extracting a top-level object with "projects" key
        const projKey = text.match(/"projects"\s*:\s*(\[/i);
        if (projKey) {
          const idx = text.indexOf('[', projKey.index);
          const last = text.lastIndexOf(']');
          if (idx !== -1 && last !== -1 && last > idx) {
            const sub = text.slice(idx, last + 1);
            try { return JSON.parse(sub); } catch (e) {}
          }
        }

        // As a last resort, return null -> caller will fallback to heuristic parser
        return null;
      }

      // Fallback heuristic parse when JSON isn't available
      fallbackParse(raw) {
        const lines = raw.split(/\n+/).map(l => l.trim()).filter(Boolean);
        const projects = [];
        let current = null;
        for (const line of lines) {
          const m = line.match(/^(?:\d+\.\s+|Project\s*\d+:?\s*)(.+)$/i);
          if (m) {
            if (current) projects.push(current);
            current = { title: m[1].trim(), description: '', components: [], technologies: [], cost: 'N/A', timeline: 'N/A', marketAppeal: 'N/A', challenges: 'N/A', uniqueValue: 'N/A', innovation: parseInt(document.getElementById('innovation').value) || 5 };
            continue;
          }
          if (!current) continue;
          // simple field detection
          if (/^Technologies[:\s\-]/i.test(line)) current.technologies = line.replace(/^Technologies[:\s\-]*/i,'').split(',').map(s=>s.trim());
          else if (/^Components[:\s\-]/i.test(line)) current.components = line.replace(/^Components[:\s\-]*/i,'').split(',').map(s=>s.trim());
          else if (/^Cost[:\s\-]/i.test(line)) current.cost = line.replace(/^Cost[:\s\-]*/i,'').trim();
          else if (/^Timeline[:\s\-]/i.test(line)) current.timeline = line.replace(/^Timeline[:\s\-]*/i,'').trim();
          else if (/^Challenges[:\s\-]/i.test(line)) current.challenges += (current.challenges === 'N/A' ? '' : ' ') + line;
          else current.description += (current.description ? ' ' : '') + line;
        }
        if (current) projects.push(current);
        return projects;
      }

      // main generation flow
      async generateProjects() {
        if (!this.apiKey) { this.showError('Please enter your OpenAI API key.'); return; }
        this.showLoading();

        const params = this.collectParameters();
        const prompt = this.buildPrompt(params);

        try {
          // Use a system message to encourage strict JSON output
          const messages = [
            { role: 'system', content: 'You are a JSON output assistant. When asked to list projects, output ONLY valid JSON and nothing else.' },
            { role: 'user', content: prompt }
          ];

          const res = await fetch('https://api.openai.com/v1/chat/completions', {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${this.apiKey}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              model: this.model,
              messages,
              temperature: 0.2,
              max_tokens: 2500
            })
          });

          if (!res.ok) {
            const t = await res.text();
            throw new Error(`OpenAI API Error ${res.status}: ${t}`);
          }

          const data = await res.json();
          let text = (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) ? data.choices[0].message.content : '';
          // attempt JSON extraction
          let parsed = this.extractJson(text);
          let projects = [];

          if (Array.isArray(parsed)) {
            projects = parsed;
          } else if (parsed && parsed.projects && Array.isArray(parsed.projects)) {
            projects = parsed.projects;
          } else {
            // fallback heuristic
            projects = this.fallbackParse(text);
          }

          // Ensure we have at most 10 objects, and normalize fields
          projects = projects.slice(0, 10).map((p, idx) => {
            // Support if parsed items might be plain strings: convert to object
            if (typeof p === 'string') return { title: p, description: '', components: [], technologies: [], cost: 'N/A', timeline: 'N/A', marketAppeal: 'N/A', challenges: 'N/A', uniqueValue: 'N/A', innovation: parseInt(params.innovation) || 5 };
            return {
              title: (p.title || p.name || `Project ${idx+1}`).toString(),
              description: (p.description || '').toString(),
              components: Array.isArray(p.components) ? p.components : (p.components ? p.components.toString().split(',').map(s=>s.trim()) : []),
              technologies: Array.isArray(p.technologies) ? p.technologies : (p.technologies ? p.technologies.toString().split(',').map(s=>s.trim()) : []),
              cost: p.cost || 'N/A',
              timeline: p.timeline || 'N/A',
              marketAppeal: p.marketAppeal || 'N/A',
              challenges: p.challenges || 'N/A',
              uniqueValue: p.uniqueValue || 'N/A',
              innovation: (typeof p.innovation === 'number') ? p.innovation : (parseInt(p.innovation) || parseInt(params.innovation) || 5)
            };
          });

          if (!projects.length) {
            this.showError('No projects found in the model response. Try adjusting parameters or the model setting.');
            return;
          }

          // Score projects using simple heuristics based on selected preferences
          const scored = this.scoreProjects(projects, params);
          // Sort descending and take top 3
          scored.sort((a,b) => b.score - a.score);
          this.displayProjects(scored.slice(0,3));
        } catch (err) {
          this.showError(err.message || String(err));
        } finally {
          this.hideLoading();
        }
      }

      // collect UI values
      collectParameters() {
        const techs = Array.from(document.querySelectorAll('.tech-checkbox:checked')).map(cb => cb.value);
        return {
          topicContext: document.getElementById('topicContext').value.trim(),
          category: document.getElementById('category').value,
          technologies: techs,
          innovation: parseInt(document.getElementById('innovation').value) || 5,
          techLevel: parseInt(document.getElementById('techLevel').value) || 5,
          resources: parseInt(document.getElementById('resources').value) || 5,
          speed: parseInt(document.getElementById('speed').value) || 5,
          price: parseInt(document.getElementById('price').value) || 5,
          marketStrength: parseInt(document.getElementById('marketStrength').value) || 5,
          budget: document.getElementById('budget') ? document.getElementById('budget').value : '',
          complexity: document.getElementById('complexity') ? document.getElementById('complexity').value : ''
        };
      }

      // scoring: simple heuristic: match preferred techs, closeness to desired innovation, marketStrength boost
      scoreProjects(projects, params) {
        return projects.map(p => {
          let score = 0;
          // tech matches
          const pref = (params.technologies || []).map(t => t.toLowerCase());
          const projTechs = (p.technologies || []).map(t => t.toLowerCase());
          const techMatches = pref.filter(t => projTechs.some(pt => pt.includes(t) || t.includes(pt))).length;
          score += techMatches * 3;

          // innovation closeness (10 max)
          const diff = Math.abs((p.innovation || 5) - (params.innovation || 5));
          score += Math.max(0, 10 - diff); // closer gives higher score

          // technical difficulty alignment: if project seems technical and user wants high tech
          if (params.techLevel >= 7 && projTechs.length >= 2) score += 2;
          if (params.resources >= 8) score += 1;

          // marketStrength preference: if user asked for strong market and there is marketAppeal text length > 20
          if (params.marketStrength >= 7 && (p.marketAppeal || '').length > 20) score += 2;

          // shorter cost preferred if user set low price
          if (params.price <= 4 && /low|cheap|\$[0-9]/i.test(p.cost || '')) score += 1;

          // small bonus if title or description contains the topic context keywords
          if (params.topicContext) {
            const ctx = params.topicContext.toLowerCase();
            if ((p.title || '').toLowerCase().includes(ctx) || (p.description || '').toLowerCase().includes(ctx)) score += 2;
          }

          // normalize final score to ~0-30 range; store it
          return { ...p, score: Math.round(score * 10) / 10 };
        });
      }

      // render top-3 projects
      displayProjects(projects) {
        const container = document.getElementById('resultsContainer');
        container.innerHTML = '';

        projects.forEach((p, index) => {
          const card = document.createElement('div');
          card.className = 'project-card bg-white p-6 rounded-xl card-shadow';

          const techTags = (p.technologies || []).map(t => `<span class="tech-tag">${this.escapeHtml(t)}</span>`).join(' ');
          const components = (p.components || []).map(c => this.escapeHtml(c)).join(', ');

          card.innerHTML = `
            <div class="flex items-start justify-between">
              <div>
                <h3 class="font-semibold text-lg">${index + 1}. ${this.escapeHtml(p.title)}</h3>
                <div class="text-xs text-gray-500 mt-1">Score: <span class="font-medium text-gray-700">${p.score ?? '—'}</span></div>
              </div>
              <div class="text-right text-sm text-gray-500">Innovation: ${p.innovation ?? '—'}</div>
            </div>

            <p class="mt-3 text-gray-700">${this.escapeHtml(p.description)}</p>

            <div class="mt-3 text-sm">
              <div><strong>Technologies:</strong> ${techTags || 'N/A'}</div>
              <div class="mt-2"><strong>Components:</strong> ${components || 'N/A'}</div>
              <div class="mt-2"><strong>Estimated Cost:</strong> ${this.escapeHtml(p.cost || 'N/A')}</div>
              <div class="mt-2"><strong>Timeline:</strong> ${this.escapeHtml(p.timeline || 'N/A')}</div>
              <div class="mt-2"><strong>Market Appeal:</strong> ${this.escapeHtml(p.marketAppeal || 'N/A')}</div>
            </div>

            <div class="mt-4 flex gap-2">
              <button class="market-btn btn-primary text-white py-1 px-3 rounded-lg" data-title="${this.escapeAttr(p.title)}">Show Market Data</button>
              <button class="onepager-btn bg-gray-100 text-gray-800 py-1 px-3 rounded-lg">One-pager</button>
            </div>

            <div class="market-data mt-3 hidden p-3 bg-gray-50 rounded-lg border border-gray-200"></div>
            <div class="onepager-data mt-3 hidden p-3 bg-white rounded-lg border border-gray-100"></div>
          `;

          container.appendChild(card);

          // market data button handler
          const marketBtn = card.querySelector('.market-btn');
          const marketDiv = card.querySelector('.market-data');
          marketBtn.addEventListener('click', async () => {
            if (!marketDiv.classList.contains('hidden')) { marketDiv.classList.add('hidden'); return; }
            marketDiv.classList.remove('hidden');
            if (marketDiv.getAttribute('data-loaded') === 'true') return;
            marketDiv.textContent = 'Fetching market insights...';

            try {
              const prompt = `Provide a concise market analysis for this senior design project:
Title: ${p.title}
Description: ${p.description}
Technologies: ${(p.technologies || []).join(', ')}

Include:
- Market overview & approximate market segments
- Top existing competitors/solutions (3) and brief differentiators
- Potential target users / early adopters
- Key risks to adoption and 2 suggested next steps for student team

Return plain text (no JSON required).`;

              const resp = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer ${this.apiKey}`,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  model: this.model,
                  messages: [{ role: 'user', content: prompt }],
                  temperature: 0.6,
                  max_tokens: 800
                })
              });

              if (!resp.ok) {
                const t = await resp.text();
                throw new Error(`OpenAI error ${resp.status}: ${t}`);
              }

              const j = await resp.json();
              const analysis = j.choices && j.choices[0] && j.choices[0].message && j.choices[0].message.content ? j.choices[0].message.content : 'No analysis returned.';
              marketDiv.textContent = analysis;
              marketDiv.setAttribute('data-loaded', 'true');
            } catch (err) {
              marketDiv.textContent = 'Error fetching market data: ' + (err.message || err);
            }
          });

          // one-pager button (brief problem, users, competitors, timeline, risks)
          const onepagerBtn = card.querySelector('.onepager-btn');
          const onepagerDiv = card.querySelector('.onepager-data');
          onepagerBtn.addEventListener('click', async () => {
            if (!onepagerDiv.classList.contains('hidden')) { onepagerDiv.classList.add('hidden'); return; }
            onepagerDiv.classList.remove('hidden');
            if (onepagerDiv.getAttribute('data-loaded') === 'true') return;
            onepagerDiv.textContent = 'Generating one-pager...';

            try {
              const prompt = `Create a concise one-pager for this senior design project (title + short description). Include sections:
1) Problem statement
2) Users / beneficiaries
3) Competitors (if any)
4) Timeline (8-month milestones)
5) Key risks

Project:
Title: ${p.title}
Description: ${p.description}
Technologies: ${(p.technologies || []).join(', ')}

Return plain text with headings.`;

              const resp = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer ${this.apiKey}`,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  model: this.model,
                  messages: [{ role: 'user', content: prompt }],
                  temperature: 0.6,
                  max_tokens: 700
                })
              });

              if (!resp.ok) {
                const t = await resp.text();
                throw new Error(`OpenAI error ${resp.status}: ${t}`);
              }

              const j = await resp.json();
              const onepager = j.choices && j.choices[0] && j.choices[0].message && j.choices[0].message.content ? j.choices[0].message.content : 'No one-pager returned.';
              onepagerDiv.textContent = onepager;
              onepagerDiv.setAttribute('data-loaded', 'true');
            } catch (err) {
              onepagerDiv.textContent = 'Error generating one-pager: ' + (err.message || err);
            }
          });
        });
      }

      // simple HTML escape helpers
      escapeHtml(str) {
        if (!str && str !== 0) return '';
        return String(str).replace(/[&<>"'`]/g, s => ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;', '`':'&#96;' })[s]);
      }
      escapeAttr(str) {
        return (str||'').replace(/"/g,'&quot;');
      }

      showLoading() {
        document.getElementById('loadingMessage').classList.remove('hidden');
        document.getElementById('errorMessage').classList.add('hidden');
        document.getElementById('resultsContainer').innerHTML = '';
      }
      hideLoading() { document.getElementById('loadingMessage').classList.add('hidden'); }

      showError(msg) {
        const el = document.getElementById('errorMessage');
        el.textContent = msg;
        el.classList.remove('hidden');
        this.hideLoading();
      }

      clearAll() {
        document.getElementById('apiKey').value = ''; this.apiKey = '';
        document.getElementById('topicContext').value = '';
        document.getElementById('category').selectedIndex = 0;
        document.querySelectorAll('.tech-checkbox').forEach(cb => cb.checked = false);
        document.getElementById('innovation').value = 5;
        document.getElementById('techLevel').value = 5;
        document.getElementById('resources').value = 5;
        document.getElementById('speed').value = 5;
        document.getElementById('price').value = 5;
        document.getElementById('marketStrength').value = 5;
        if (document.getElementById('budget')) document.getElementById('budget').selectedIndex = 0;
        if (document.getElementById('complexity')) document.getElementById('complexity').selectedIndex = 0;
        document.getElementById('resultsContainer').innerHTML = '';
        document.getElementById('errorMessage').classList.add('hidden');
      }
    }

    // Initialize
    window.ideationTool = new AIIdeationTool();
  </script>
</body>
</html>
