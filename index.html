<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ECE Senior Project Idea Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-green-900 text-white min-h-screen p-6">
  <div class="max-w-5xl mx-auto bg-green-800 rounded-2xl shadow-lg p-6">
    <h1 class="text-3xl font-bold mb-4">ECE Senior Project Idea Generator</h1>
    <p class="text-green-200 mb-6">Enter your API key, select criteria, and generate 10 project ideas. The app will score them and display the top 3.</p>

    <!-- API Key & Context -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <div>
        <label class="block text-sm mb-1">AI API Key</label>
        <input id="apiKey" type="text" placeholder="sk-..." class="w-full p-2 rounded-lg bg-green-700 border border-green-500" />

        <label class="block text-sm mt-4 mb-1">Topic Context (optional)</label>
        <textarea id="context" rows="3" placeholder="Optional: narrow requirements..." class="w-full p-2 rounded-lg bg-green-700 border border-green-500"></textarea>
      </div>

      <div>
        <label class="block text-sm mb-1">Category</label>
        <select id="category" class="w-full p-2 rounded-lg bg-green-700 border border-green-500">
          <option value="edtech">EdTech</option>
          <option value="iot">IoT / Embedded</option>
          <option value="health">Health</option>
          <option value="fintech">Fintech</option>
          <option value="sustainability">Sustainability</option>
          <option value="campus">Campus Life</option>
        </select>

        <label class="block text-sm mt-4 mb-1">Model</label>
        <select id="model" class="w-full p-2 rounded-lg bg-green-700 border border-green-500">
          <option value="gpt-4o">gpt-4o</option>
          <option value="gpt-4o-mini">gpt-4o-mini</option>
          <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
        </select>
      </div>
    </div>

    <!-- Sliders -->
    <div class="grid md:grid-cols-3 gap-6 mb-6">
      <div>
        <label class="block text-sm mb-1">Innovation (1 practical — 10 radical)</label>
        <input type="range" id="innovation" min="1" max="10" value="5" class="w-full" oninput="V('innovationVal',this.value)" />
        <div id="innovationVal" class="mt-1 text-green-300">5</div>

        <label class="block text-sm mt-4 mb-1">Tech skill (1 low — 10 high)</label>
        <input type="range" id="tech" min="1" max="10" value="5" class="w-full" oninput="V('techVal',this.value)" />
        <div id="techVal" class="mt-1 text-green-300">5</div>

        <label class="block text-sm mt-4 mb-1">Resources (1 few — 10 a lot)</label>
        <input type="range" id="resources" min="1" max="10" value="5" class="w-full" oninput="V('resourcesVal',this.value)" />
        <div id="resourcesVal" class="mt-1 text-green-300">5</div>
      </div>

      <div>
        <label class="block text-sm mb-1">Timeline speed (1 slow — 10 fast)</label>
        <input type="range" id="timeline" min="1" max="10" value="5" class="w-full" oninput="V('timelineVal',this.value)" />
        <div id="timelineVal" class="mt-1 text-green-300">5</div>

        <label class="block text-sm mt-4 mb-1">Price (1 low — 10 high)</label>
        <input type="range" id="price" min="1" max="10" value="5" class="w-full" oninput="V('priceVal',this.value)" />
        <div id="priceVal" class="mt-1 text-green-300">5</div>

        <label class="block text-sm mt-4 mb-1">Market strength (1 weak — 10 strong)</label>
        <input type="range" id="market" min="1" max="10" value="5" class="w-full" oninput="V('marketVal',this.value)" />
        <div id="marketVal" class="mt-1 text-green-300">5</div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex items-center gap-4 mb-6">
      <button id="generate" class="bg-yellow-400 text-black font-bold px-4 py-2 rounded-lg">Generate Ideas</button>
      <button id="clear" class="bg-green-700 border border-green-500 px-4 py-2 rounded-lg">Clear</button>
      <div class="ml-auto text-green-200 text-sm">Results: <span id="resultCount">0</span></div>
    </div>

    <!-- Selector Bar -->
    <div class="flex gap-2 mb-4">
      <button id="tabIdeas" class="bg-green-700 border border-green-500 px-4 py-2 rounded-lg">Ideas</button>
      <button id="tabScores" class="bg-green-700 border border-green-500 px-4 py-2 rounded-lg">Scores</button>
      <button id="tabOnepager" class="bg-green-700 border border-green-500 px-4 py-2 rounded-lg">One-pager</button>
    </div>

    <!-- Output -->
    <div id="output" class="space-y-4"></div>

    <div class="mt-6 p-4 bg-yellow-800 border border-yellow-400 rounded-lg text-sm">
      <strong>Hosting note:</strong> Push this file as <code>index.html</code> to GitHub Pages. <br/> Warning: entering your API key in-browser exposes it to anyone with access.
    </div>
  </div>

<script>
function V(id,v){document.getElementById(id).innerText=v}

const output=document.getElementById('output');
const resultCount=document.getElementById('resultCount');
let currentTab='ideas';
let projects=[];

function scoreProject(p,targets){
  const attrs=["innovation","tech","resources","timeline","price","market"];
  let total=0;
  attrs.forEach(a=>{total+=10-Math.abs((p.scores[a]||5)-targets[a]);});
  return Math.round(total/attrs.length*10);
}

document.getElementById('generate').onclick=async()=>{
  const key=document.getElementById('apiKey').value.trim();
  if(!key){alert('Enter API key');return;}
  const context=document.getElementById('context').value;
  const category=document.getElementById('category').value;
  const model=document.getElementById('model').value;

  const targets={
    innovation:+document.getElementById('innovation').value,
    tech:+document.getElementById('tech').value,
    resources:+document.getElementById('resources').value,
    timeline:+document.getElementById('timeline').value,
    price:+document.getElementById('price').value,
    market:+document.getElementById('market').value,
  };

  output.innerHTML='<p>Generating ideas...</p>';

  const prompt=`Generate 10 unique ECE senior project ideas in category ${category}. ${context||''} Return strict JSON array where each item has: title, desc, tags (array), and scores {innovation, tech, resources, timeline, price, market} (integers 1-10).`;

  try{
    const res=await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{"Content-Type":"application/json","Authorization":"Bearer "+key},
      body:JSON.stringify({model,messages:[{role:"user",content:prompt}],temperature:0.7})
    });
    const data=await res.json();
    const text=data.choices[0].message.content;
    let parsed;
    try{parsed=JSON.parse(text);}catch{parsed=JSON.parse(text.match(/\[[\s\S]*\]/)[0]);}
    projects=parsed.map(p=>({...p,match:scoreProject(p,targets)}));
    projects.sort((a,b)=>b.match-a.match);
    projects=projects.slice(0,3);
    resultCount.textContent=projects.length;
    render();
  }catch(err){
    output.innerHTML='<p class="text-red-400">Error: '+err+'</p>';
  }
};

function render(){
  output.innerHTML='';
  if(projects.length===0){output.innerHTML='<p class="text-green-300">No results yet.</p>';return;}
  if(currentTab==='ideas'){
    projects.forEach(p=>{
      output.innerHTML+=`<div class='p-4 bg-green-700 rounded-lg'><h3 class='text-xl font-bold mb-2'>${p.title}</h3><p class='text-green-200 mb-2'>${p.desc}</p><div class='flex flex-wrap gap-2 mb-2'>${p.tags.map(t=>`<span class='bg-yellow-400 text-black px-2 py-1 rounded-full text-xs'>${t}</span>`).join('')}</div><div class='text-sm text-green-300'>Innovation: ${p.scores.innovation} | Tech: ${p.scores.tech} | Resources: ${p.scores.resources} | Timeline: ${p.scores.timeline} | Price: ${p.scores.price} | Market: ${p.scores.market} | Match: ${p.match}%</div></div>`;
    });
  } else if(currentTab==='scores'){
    projects.forEach(p=>{
      output.innerHTML+=`<div class='p-4 bg-green-700 rounded-lg flex justify-between'><span class='font-bold'>${p.title}</span><span class='text-green-300'>Match: ${p.match}%</span></div>`;
    });
  } else if(currentTab==='onepager'){
    projects.forEach(p=>{
      output.innerHTML+=`<div class='p-4 bg-green-700 rounded-lg'><h3 class='text-xl font-bold mb-2'>${p.title}</h3><p class='mb-2 text-green-200'>${p.desc}</p><h4 class='font-semibold'>Problem</h4><p class='text-green-200 mb-2'>[Define problem]</p><h4 class='font-semibold'>Users</h4><p class='text-green-200 mb-2'>[Target users]</p><h4 class='font-semibold'>Competitors</h4><p class='text-green-200 mb-2'>[Competitor landscape]</p><h4 class='font-semibold'>Timeline</h4><p class='text-green-200 mb-2'>[Development timeline]</p><h4 class='font-semibold'>Risks</h4><p class='text-green-200 mb-2'>[Risks & challenges]</p><div class='flex flex-wrap gap-2'>${p.tags.map(t=>`<span class='bg-yellow-400 text-black px-2 py-1 rounded-full text-xs'>${t}</span>`).join('')}</div></div>`;
    });
  }
}

['tabIdeas','tabScores','tabOnepager'].forEach(id=>{
  document.getElementById(id).onclick=()=>{currentTab=id==='tabIdeas'?'ideas':id==='tabScores'?'scores':'onepager';render();};
});

document.getElementById('clear').onclick=()=>{
  // reset results
  output.innerHTML='<p class="text-green-300">No results yet.</p>';
  projects=[];
  resultCount.textContent='0';

  // reset inputs
  document.getElementById('apiKey').value='';
  document.getElementById('context').value='';
  document.getElementById('category').selectedIndex=0;
  document.getElementById('model').selectedIndex=0;

  ['innovation','tech','resources','timeline','price','market'].forEach(id=>{
    document.getElementById(id).value=5;
    V(id+"Val",5);
  });
};
</script>
</body>
</html>
